<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoSimRPG - √âtape 3 : G√©n√©ration 0</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="step1-style.css"> 
    <link rel="stylesheet" href="step3-style.css">
</head>
<body>

<nav class="floating-menu">
    <div class="menu-title">EcoSimRPG</div>
    <a href="index.html" id="nav-index">Accueil</a>
    <a href="step1.html" id="nav-step1">√âtape 1<br><small>(Carte)</small></a>
    <a href="step2.html" id="nav-step2">√âtape 2<br><small>(Conf. Lieux)</small></a>
    <a href="step3.html" id="nav-step3" class="active">√âtape 3<br><small>(Gen.0)</small></a>
</nav>

<div class="page-container-step3">

    <header id="top-dashboard-banner">
        <div class="dashboard-section">
            <h4>D√©mographie Globale</h4>
            <div id="global-stats-container">
                <p><strong>Population Totale :</strong> <span id="global-total-population">0</span></p>
                <p><strong>Nombre de Familles :</strong> <span id="global-family-count">0</span></p>
            </div>
        </div>

        <div class="dashboard-section dashboard-section-large">
            <h4>Distances & Temps de Trajet</h4>
            <div id="distance-matrix-container">
                <p>Les donn√©es de distance appara√Ætront ici.</p>
            </div>
        </div>

        <div class="dashboard-section bottom-actions">
            <button id="finalize-simulation-btn" class="btn btn-primary" disabled>Finaliser et D√©marrer la Simulation</button>
        </div>
    </header>

    <div class="main-content-wrapper-step3">

        <aside class="side-panel-step3" id="left-panel-step3">
            <h3>Lieux de la R√©gion</h3>
            <ul id="places-list-step3">
            </ul>
        </aside>

        <main class="main-panel-step3" id="main-panel-step3">
            <div id="welcome-panel">
                <h2>Bienvenue √† l'√âtape 3 : La G√©n√©ration Originelle</h2>
                <p>S√©lectionnez un lieu dans le panneau de gauche pour commencer √† d√©finir sa population initiale.</p>
                <p>C'est ici que votre monde prend vie. Vous allez fa√ßonner la d√©mographie, les familles et les premi√®res g√©n√©rations qui peupleront vos terres.</p>
                <div class="welcome-icon">üß¨</div>
            </div>

            <div id="config-panel" class="hidden">
                <h1 id="config-panel-title">Configuration de [Nom du Lieu]</h1>

                <section class="config-section">
                    <h2>1. Distribution des Races Originelles</h2>
                    <div id="race-distribution-container">
                    </div>
                    <div class="race-total-container">
                        <span>Total :</span>
                        <span id="race-total-percentage">0 / 100 %</span>
                    </div>
                </section>

                <section class="config-section">
                    <h2>2. R√®gles Sociales</h2>
                    <div class="social-rules-container">
                        <input type="checkbox" id="interracial-marriage-toggle" checked>
                        <label for="interracial-marriage-toggle">Autoriser les mariages inter-raciaux (selon compatibilit√©s)</label>
                    </div>
                </section>

                <section class="config-section">
                    <h2>3. Population & Actions</h2>
                    
                    <div class="workflow-warning">
                        <p><strong>Conseil :</strong> Il est recommand√© de cr√©er et d'ajouter vos familles personnalis√©es <em>avant</em> d'utiliser la fonction de "Pr√©-g√©n√©rer la Population" pour garantir que les emplois que vous assignez sont disponibles.</p>
                    </div>

                    <div class="population-stats-grid">
                        <div><strong>Population Totale :</strong> <span id="stat-total-population">0</span></div>
                        <div><strong>Nombre de Familles :</strong> <span id="stat-family-count">0</span></div>
                        <div><strong>Postes √† Pourvoir :</strong> <span id="stat-total-jobs">0</span></div>
                        <div><strong>Postes Occup√©s :</strong> <span id="stat-filled-jobs">0</span></div>
                    </div>
                    <div class="action-buttons-container">
                        <button id="pre-generate-btn" class="btn btn-primary" disabled>üèõÔ∏è Pr√©-g√©n√©rer la Population</button>
                        <button id="manage-families-btn" class="btn btn-edit">üë§ G√©rer les Familles Personnalis√©es</button>
                    </div>
                    <div class="action-buttons-container secondary-actions">
                        <button id="reset-gen0-btn" class="btn btn-warning">‚ôªÔ∏è Reset Gen0</button>
                        <button id="reset-all-btn" class="btn btn-danger">‚ùå Reset Total</button>
                    </div>
                </section>
                
                <section class="config-section">
                    <h2>Population G√©n√©r√©e</h2>
                    <div id="family-list-container">
                        <p>Aucune population n'a encore √©t√© g√©n√©r√©e pour ce lieu.</p>
                    </div>
                </section>

            </div>
        </main>
    </div>
</div>


<dialog id="family-library-modal">
    <div class="modal-header">
        <h3>Biblioth√®que de Familles</h3>
        <button class="modal-close-btn">&times;</button>
    </div>
    <div class="modal-content">
        <p>G√©rez vos mod√®les de familles ici. Chargez un mod√®le pour l'√©diter et l'ajouter au lieu s√©lectionn√©.</p>
        <div id="family-templates-list">
            </div>
        <div class="modal-actions">
            <button id="create-new-template-btn" class="btn btn-primary">Cr√©er un nouveau mod√®le de famille</button>
        </div>
    </div>
</dialog>


<dialog id="family-modal">
    <div class="modal-header">
        <h3 id="family-modal-title">Cr√©ateur de Famille</h3>
        <button class="modal-close-btn">&times;</button>
    </div>
    <form id="family-form" method="dialog">
        <input type="hidden" id="editing-family-template-id">
        <div class="form-group">
            <label for="family-name">Nom de Famille :</label>
            <input type="text" id="family-name" required>
        </div>

        <h4>Membres</h4>
        <div id="family-members-list"></div>
        
        <div id="add-member-section">
            <h5>Ajouter un Nouveau Membre</h5>
            <div class="form-grid">
                <div class="form-group">
                    <label for="member-firstname">Pr√©nom :</label>
                    <input type="text" id="member-firstname">
                </div>
                <div class="form-group">
                    <label for="member-race">Race :</label>
                    <select id="member-race"></select>
                </div>
                <div class="form-group">
                    <label for="member-age">√Çge :</label>
                    <input type="number" id="member-age" min="0">
                </div>
                <div class="form-group">
                    <label for="member-gender">Sexe :</label>
                    <select id="member-gender">
                        <option value="Homme">Homme</option>
                        <option value="Femme">Femme</option>
                    </select>
                </div>
            </div>
            
            <h5>Assignation Professionnelle (Optionnel)</h5>
            <div class="form-grid">
                <div class="form-group">
                    <label for="member-work-location">Lieu de travail :</label>
                    <select id="member-work-location">
                        <option value="">Aucun</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="member-work-building">B√¢timent :</label>
                    <select id="member-work-building" disabled></select>
                </div>
                <div class="form-group">
                    <label for="member-work-job">Poste :</label>
                    <select id="member-work-job" disabled></select>
                </div>
            </div>
            <button type="button" id="add-member-btn" class="btn">Ajouter ce membre</button>
        </div>
        
        <div class="modal-actions">
            <button type="button" id="cancel-family-btn" class="btn">Annuler</button>
            <button type="button" id="save-family-template-btn" class="btn btn-secondary">Sauvegarder le mod√®le</button>
            <button type="submit" id="confirm-add-family-btn" class="btn-primary" disabled>Ajouter au Lieu</button>
        </div>
    </form>
</dialog>

<dialog id="character-details-modal">
    <div class="modal-header">
        <h3 id="char-modal-title">D√©tails du Personnage</h3>
        <button class="modal-close-btn">&times;</button>
    </div>
    <div class="char-modal-content">
        <div class="char-details-grid">
            <div class="char-detail-item"><strong>Nom Complet :</strong> <span id="char-modal-fullname"></span></div>
            <div class="char-detail-item"><strong>Race :</strong> <span id="char-modal-race"></span></div>
            <div class="char-detail-item"><strong>√Çge :</strong> <span id="char-modal-age"></span> ans</div>
            <div class="char-detail-item"><strong>Sexe :</strong> <span id="char-modal-gender"></span></div>
        </div>
        
        <h4>Vie Professionnelle</h4>
        <div class="char-details-grid">
             <div class="char-detail-item"><strong>Profession :</strong> <span id="char-modal-job"></span></div>
             <div class="char-detail-item"><strong>Lieu de travail :</strong> <span id="char-modal-workplace"></span></div>
             <div class="char-detail-item"><strong>Salaire :</strong> <span id="char-modal-salary"></span> Cu</div>
             <div class="char-detail-item"><strong>Prestige Actuel :</strong> <span id="char-modal-prestige"></span></div>
        </div>

        <h4>Gains de Carri√®re (par mois)</h4>
        <div id="char-modal-monthly-gains" class="char-details-grid">
            </div>

        <h4>Attributs Actuels</h4>
        <ul id="char-modal-stats">
            </ul>

        <h4>Famille</h4>
        <div id="char-modal-family-info">
            </div>
        
        <h4>Aspirations Sociales</h4>
        <div class="char-details-grid">
            <div class="char-detail-item"><strong>Enfants d√©sir√©s :</strong> <span id="char-modal-desired-children"></span></div>
            <div class="char-detail-item"><strong>Amis souhait√©s :</strong> <span id="char-modal-desired-friends"></span></div>
            <div class="char-detail-item"><strong>Connaissances souhait√©es :</strong> <span id="char-modal-desired-acquaintances"></span></div>
        </div>
    </div>
</dialog>

<script src="races.js"></script>
<script src="buildings.js"></script>
<script src="step3.js"></script>

</body>
</html>